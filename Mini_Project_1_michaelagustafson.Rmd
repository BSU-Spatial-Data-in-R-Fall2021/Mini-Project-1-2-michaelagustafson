---
title: "Mini Project 1"
author: "Michaela Gustafson"
date: "10/16/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Spatial Data in R: Mini Project 1

The goals for this phase of your final project are:

Articulate an interesting research question based on a dataset you’d like to learn more about.

Develop a spatial database that contains potentially relevant explanatory variables that you’d like to explore in the context of that research question.

Demonstrate an understanding of the various workflow elements involved in designing and constructing a spatial database for subsequent visualization and analysis.

```{r library}
library(here)
library(tidyr)
library(dplyr)
library(terra)
library(sf)
library(tidyverse)

```
# New Zealand Data

https://rdrr.io/cran/spData/man/nz.html

```{r gitnzcencsu}
# Find "Regional Council 2018 Clipped (generalised)"
# select the GeoPackage option in the "Vectors/tables" dropdown
# at https://datafinder.stats.govt.nz/data/ (requires registration)
# Save the result as:

unzip("statsnzregional-council-2018-clipped-generalised-SHP.zip")
nz.full.shp <- st_read("regional-council-2018-clipped-generalised.shp")

plot(st_geometry(nz.full.shp))
# print(object.size(nz_full), units = "Kb") # 14407.2 Kb

# nz <- st_simplify(nz_full, dTolerance = 1000)


names(nz.full.shp)
nz.full.shp$REGC2018_1
nz = filter(nz.full.shp, REGC2018_1 != "Area Outside Region") %>%
        select(Region = REGC2018_1)

st_is_valid(nz)
st_crs(nz)

nz.reg.coun <- read.csv("regional_council_2018_csv.csv")
nz.reg.coun <- filter(nz.reg.coun, REGC2018_V1_00_NAME != "Area Outside Region") %>%
  select(Region = REGC2018_V1_00_NAME, Area_SQKM = LAND_AREA_SQ_KM)

# join nz.reg.coun with spatial data nz

nz.shp <- inner_join(nz, nz.reg.coun, by = "Region")


```

# Upload census data and join with shapefile
```{r nzcensus}
nz.census <- read.csv("Census_Usually_resident_population_count_and_change_by_region_2006_2013_and_2018.csv")

names(nz.census)
nz.census <- filter(nz.census, X...Census.year == "2018") %>%
  select(Year = X...Census.year, Region, Population = Value)


census2 <- read.csv("2018-Census-urban-accessibility-dataset-csv.csv")

census2 <- census2 %>% 
  dplyr::select(RC_IUA2018_V1_00_NAME, starts_with("C18"))



```

# Urban vs Rural shapefile

```{r urbrur}
unzip("statsnzurban-rural-2021-generalised-SHP.zip")
urbrur <- read_sf("urban-rural-2021-generalised.shp")
plot(st_geometry(urbrur))

unique(urbrur$IUR2021__1)

head(urbrur)

urban <- urbrur %>%
  select(Name = UR2021_V_2, Urban = IUR2021__1, AreaSQKM = AREA_SQ_KM, geometry)

head(urban)

```

# Elevation
```{r}
library(ggplot2)
library(raster)
library(elevatr)
library(viridis)

nz.elev <- get_elev_raster(locations = nz.shp, z = 9)

```


# Upload zombie data

```{r zombieload}

zom <- read.csv("zombies.csv")

head(zom); dim(zom)

zombie.shp <- read_sf(here("New_Zealand_Zombie_Attack_Data.shp"))
plot(zombie.shp)

```







